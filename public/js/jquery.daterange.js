!function(e){"function"==typeof define&&define.amd?define(["jquery","moment"],e):"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery"),require("moment")):e(jQuery,moment)}(function(e,t){"use strict";e.dateRangePickerLanguages={default:{selected:"Selected:",day:"Day",days:"Days",apply:"Close","week-1":"mo","week-2":"tu","week-3":"we","week-4":"th","week-5":"fr","week-6":"sa","week-7":"su","week-number":"W","month-name":["january","february","march","april","may","june","july","august","september","october","november","december"],shortcuts:"Shortcuts","custom-values":"Custom Values",past:"Past",following:"Following",previous:"Previous","prev-week":"Week","prev-month":"Month","prev-year":"Year",next:"Next","next-week":"Week","next-month":"Month","next-year":"Year","less-than":"Date range should not be more than %d days","more-than":"Date range should not be less than %d days","default-more":"Please select a date range longer than %d days","default-single":"Please select a date","default-less":"Please select a date range less than %d days","default-range":"Please select a date range between %d and %d days","default-default":"Please select a date range",time:"Time",hour:"Hour",minute:"Minute"}},e.fn.dateRangePicker=function(a){a||(a={}),(a=e.extend(!0,{autoClose:!1,format:"YYYY-MM-DD",separator:" to ",language:"auto",startOfWeek:"sunday",getValue:function(){return e(this).val()},setValue:function(t){e(this).attr("readonly")||e(this).is(":disabled")||t==e(this).val()||e(this).val(t)},startDate:!1,endDate:!1,time:{enabled:!1},minDays:0,maxDays:0,showShortcuts:!1,shortcuts:{},customShortcuts:[],inline:!1,container:"body",alwaysOpen:!1,singleDate:!1,lookBehind:!1,batchMode:!1,duration:200,stickyMonths:!1,dayDivAttrs:[],dayTdAttrs:[],selectForward:!1,selectBackward:!1,applyBtnClass:"",singleMonth:"auto",hoveringTooltip:function(e,t,a){return e>1?e+" "+G("days"):""},showTopbar:!0,swapTime:!1,showWeekNumbers:!1,getWeekNumber:function(e){return t(e).format("w")},customOpenAnimation:null,customCloseAnimation:null,customArrowPrevSymbol:null,customArrowNextSymbol:null,monthSelect:!1,yearSelect:!1},a)).start=!1,a.end=!1,a.startWeek=!1,a.isTouchDevice="ontouchstart"in window||navigator.msMaxTouchPoints,a.isTouchDevice&&(a.hoveringTooltip=!1),"auto"==a.singleMonth&&(a.singleMonth=e(window).width()<480),a.singleMonth&&(a.stickyMonths=!1),a.showTopbar||(a.autoClose=!0),a.startDate&&"string"==typeof a.startDate&&(a.startDate=t(a.startDate,a.format).toDate()),a.endDate&&"string"==typeof a.endDate&&(a.endDate=t(a.endDate,a.format).toDate()),a.yearSelect&&"boolean"==typeof a.yearSelect&&(a.yearSelect=function(e){return[e-5,e+5]});var n,s,r=function(){if("auto"==a.language){var t=navigator.language?navigator.language:navigator.browserLanguage;return t&&(t=t.toLowerCase())in e.dateRangePickerLanguages?e.dateRangePickerLanguages[t]:e.dateRangePickerLanguages.default}return a.language&&a.language in e.dateRangePickerLanguages?e.dateRangePickerLanguages[a.language]:e.dateRangePickerLanguages.default}(),i=!1,o=this,d=e(o).get(0);return e(this).off(".datepicker").on("click.datepicker",function(e){n.is(":visible")||c(a.duration)}).on("change.datepicker",function(e){f()}).on("keyup.datepicker",function(){try{clearTimeout(s)}catch(e){}s=setTimeout(function(){f()},2e3)}),function(){var s=this;if(e(this).data("date-picker-opened"))return void R();e(this).data("date-picker-opened",!0),(n=function(){var t,n='<div class="date-picker-wrapper';a.extraClass&&(n+=" "+a.extraClass+" "),a.singleDate&&(n+=" single-date "),a.showShortcuts||(n+=" no-shortcuts "),a.showTopbar||(n+=" no-topbar "),a.customTopBar&&(n+=" custom-topbar "),n+='">',a.showTopbar&&(n+='<div class="drp_top-bar">',a.customTopBar?("function"==typeof a.customTopBar&&(a.customTopBar=a.customTopBar()),n+='<div class="custom-top">'+a.customTopBar+"</div>"):(n+='<div class="normal-top"><span class="selection-top">'+G("selected")+' </span> <b class="start-day">...</b>',a.singleDate||(n+=' <span class="separator-day">'+a.separator+'</span> <b class="end-day">...</b> <i class="selected-days">(<span class="selected-days-num">3</span> '+G("days")+")</i>"),n+="</div>",n+='<div class="error-top">error</div><div class="default-top">default</div>'),n+='<input type="button" class="apply-btn disabled'+(t="",!0===a.autoClose&&(t+=" hide"),""!==a.applyBtnClass&&(t+=" "+a.applyBtnClass),t)+'" value="'+G("apply")+'" />',n+="</div>");var s=a.showWeekNumbers?6:5,r="&lt;";a.customArrowPrevSymbol&&(r=a.customArrowPrevSymbol);var i="&gt;";if(a.customArrowNextSymbol&&(i=a.customArrowNextSymbol),n+='<div class="month-wrapper">   <table class="month1" cellspacing="0" border="0" cellpadding="0">       <thead>           <tr class="caption">               <th>                   <span class="prev">'+r+'                   </span>               </th>               <th colspan="'+s+'" class="month-name">               </th>               <th>'+(a.singleDate||!a.stickyMonths?'<span class="next">'+i+"</span>":"")+'               </th>           </tr>           <tr class="week-name">'+E()+"       </thead>       <tbody></tbody>   </table>",a.singleMonth||(n+='<div class="gap">'+function(){for(var e=['<div class="gap-top-mask"></div><div class="gap-bottom-mask"></div><div class="gap-lines">'],t=0;t<20;t++)e.push('<div class="gap-line"><div class="gap-1"></div><div class="gap-2"></div><div class="gap-3"></div></div>');return e.push("</div>"),e.join("")}()+'</div><table class="month2" cellspacing="0" border="0" cellpadding="0">   <thead>   <tr class="caption">       <th>'+(a.stickyMonths?"":'<span class="prev">'+r+"</span>")+'       </th>       <th colspan="'+s+'" class="month-name">       </th>       <th>           <span class="next">'+i+'</span>       </th>   </tr>   <tr class="week-name">'+E()+"   </thead>   <tbody></tbody></table>"),n+='<div class="dp-clearfix"></div><div class="time"><div class="time1"></div>',a.singleDate||(n+='<div class="time2"></div>'),n+='</div><div class="dp-clearfix"></div></div>',n+='<div class="footer">',a.showShortcuts){n+='<div class="shortcuts"><b>'+G("shortcuts")+"</b>";var o=a.shortcuts;if(o){var d;if(o["prev-days"]&&o["prev-days"].length>0){n+='&nbsp;<span class="prev-days">'+G("past");for(var l=0;l<o["prev-days"].length;l++)d=o["prev-days"][l],d+=o["prev-days"][l]>1?G("days"):G("day"),n+=' <a href="javascript:;" shortcut="day,-'+o["prev-days"][l]+'">'+d+"</a>";n+="</span>"}if(o["next-days"]&&o["next-days"].length>0){n+='&nbsp;<span class="next-days">'+G("following");for(var l=0;l<o["next-days"].length;l++)d=o["next-days"][l],d+=o["next-days"][l]>1?G("days"):G("day"),n+=' <a href="javascript:;" shortcut="day,'+o["next-days"][l]+'">'+d+"</a>";n+="</span>"}if(o.prev&&o.prev.length>0){n+='&nbsp;<span class="prev-buttons">'+G("previous");for(var l=0;l<o.prev.length;l++)d=G("prev-"+o.prev[l]),n+=' <a href="javascript:;" shortcut="prev,'+o.prev[l]+'">'+d+"</a>";n+="</span>"}if(o.next&&o.next.length>0){n+='&nbsp;<span class="next-buttons">'+G("next");for(var l=0;l<o.next.length;l++)d=G("next-"+o.next[l]),n+=' <a href="javascript:;" shortcut="next,'+o.next[l]+'">'+d+"</a>";n+="</span>"}}if(a.customShortcuts)for(var l=0;l<a.customShortcuts.length;l++){var c=a.customShortcuts[l];n+='&nbsp;<span class="custom-shortcut"><a href="javascript:;" shortcut="custom">'+c.name+"</a></span>"}n+="</div>"}if(a.showCustomValues&&(n+='<div class="customValues"><b>'+(a.customValueLabel||G("custom-values"))+"</b>",a.customValues))for(var l=0;l<a.customValues.length;l++){var f=a.customValues[l];n+='&nbsp;<span class="custom-value"><a href="javascript:;" custom="'+f.value+'">'+f.name+"</a></span>"}return e(n+="</div></div>")}().hide()).append('<div class="date-range-length-tip"></div>'),e(a.container).append(n),a.inline?n.addClass("inline-wrapper"):l();a.alwaysOpen&&n.find(".apply-btn").hide();var r=J();if(K(r),a.time.enabled)if(a.startDate&&a.endDate||a.start&&a.end)B(t(a.start||a.startDate).toDate(),"time1"),B(t(a.end||a.endDate).toDate(),"time2");else{var o=a.defaultEndTime?a.defaultEndTime:r;B(r,"time1"),B(o,"time2")}var c="";c=a.singleDate?G("default-single"):a.minDays&&a.maxDays?G("default-range"):a.minDays?G("default-more"):a.maxDays?G("default-less"):G("default-default");n.find(".default-top").html(c.replace(/\%d/,a.minDays).replace(/\%d/,a.maxDays)),a.singleMonth?n.addClass("single-month"):n.addClass("two-months");setTimeout(function(){h(),i=!0},0),n.click(function(e){e.stopPropagation()}),e(document).on("click.datepicker",X),n.find(".next").click(function(){a.stickyMonths?function(e){var t=_(a.month1),n=_(a.month2);if(z(n))return;if(!a.singleDate&&F(t,n)>=0)return;P(t,"month1"),P(n,"month2"),W()}():function(t){var n=e(t).parents("table").hasClass("month2"),s=n?a.month2:a.month1;if(s=_(s),!a.singleMonth&&!a.singleDate&&!n&&F(s,a.month2)>=0||z(s))return;P(s,n?"month2":"month1"),N()}(this)}),n.find(".prev").click(function(){a.stickyMonths?function(e){var t=q(a.month1),n=q(a.month2);if(z(t))return;if(!a.singleDate&&F(n,t)<=0)return;P(n,"month2"),P(t,"month1"),W()}():function(t){var n=e(t).parents("table").hasClass("month2"),s=n?a.month2:a.month1;if(s=q(s),n&&F(s,a.month1)<=0||z(s))return;P(s,n?"month2":"month1"),N()}(this)}),n.attr("unselectable","on").css("user-select","none").on("selectstart",function(e){return e.preventDefault(),!1}),n.find(".apply-btn").click(function(){R();var t=L(new Date(a.start))+a.separator+L(new Date(a.end));e(s).trigger("datepicker-apply",{value:t,date1:new Date(a.start),date2:new Date(a.end)})}),n.find("[custom]").click(function(){var t=e(this).attr("custom");a.start=!1,a.end=!1,n.find(".day.checked").removeClass("checked"),a.setValue.call(d,t),x(),T(!0),W(),a.autoClose&&R()}),n.find("[shortcut]").click(function(){var t,n=e(this).attr("shortcut"),s=new Date,r=!1;if(-1!=n.indexOf("day")){var i=parseInt(n.split(",",2)[1],10);r=new Date((new Date).getTime()+864e5*i),s=new Date(s.getTime()+864e5*(i>0?1:-1))}else if(-1!=n.indexOf("week")){var o;for(t=-1!=n.indexOf("prev,")?-1:1,o=1==t?"monday"==a.startOfWeek?1:0:"monday"==a.startOfWeek?0:6,s=new Date(s.getTime()-864e5);s.getDay()!=o;)s=new Date(s.getTime()+864e5*t);r=new Date(s.getTime()+864e5*t*6)}else if(-1!=n.indexOf("month"))t=-1!=n.indexOf("prev,")?-1:1,(r=1==t?_(s):q(s)).setDate(1),(s=_(r)).setDate(1),s=new Date(s.getTime()-864e5);else if(-1!=n.indexOf("year"))t=-1!=n.indexOf("prev,")?-1:1,(r=new Date).setFullYear(s.getFullYear()+t),r.setMonth(0),r.setDate(1),s.setFullYear(s.getFullYear()+t),s.setMonth(11),s.setDate(31);else if("custom"==n){var d=e(this).html();if(a.customShortcuts&&a.customShortcuts.length>0)for(var l=0;l<a.customShortcuts.length;l++){var c=a.customShortcuts[l];if(c.name==d){var f=[];if((f=c.dates.call())&&2==f.length&&(r=f[0],s=f[1]),f&&1==f.length){var m=f[0];P(m,"month1"),P(_(m),"month2"),N()}break}}}r&&s&&(S(r,s),x())}),n.find(".time1 input[type=range]").on("change touchmove",function(t){var a=t.target,n="hour"==a.name?e(a).val().replace(/^(\d{1})$/,"0$1"):void 0,s="minute"==a.name?e(a).val().replace(/^(\d{1})$/,"0$1"):void 0;v("time1",n,s)}),n.find(".time2 input[type=range]").on("change touchmove",function(t){var a=t.target,n="hour"==a.name?e(a).val().replace(/^(\d{1})$/,"0$1"):void 0,s="minute"==a.name?e(a).val().replace(/^(\d{1})$/,"0$1"):void 0;v("time2",n,s)})}.call(this),a.alwaysOpen&&c(0),e(this).data("dateRangePicker",{setStart:function(e){return"string"==typeof e&&(e=t(e,a.format).toDate()),a.end=!1,I(e),this},setEnd:function(e,n){var s=new Date;return s.setTime(a.start),"string"==typeof e&&(e=t(e,a.format).toDate()),S(s,e,n),this},setDateRange:function(e,n,s){"string"==typeof e&&"string"==typeof n&&(e=t(e,a.format).toDate(),n=t(n,a.format).toDate()),S(e,n,s)},clear:function(){a.start=!1,a.end=!1,n.find(".day.checked").removeClass("checked"),n.find(".day.last-date-selected").removeClass("last-date-selected"),n.find(".day.first-date-selected").removeClass("first-date-selected"),a.setValue.call(d,""),x(),T(),W()},close:R,open:c,redraw:H,getDatePicker:function(){return n},resetMonthsView:K,destroy:function(){e(o).off(".datepicker"),e(o).data("dateRangePicker",""),e(o).data("date-picker-opened",null),n.remove(),e(window).off("resize.datepicker",l),e(document).off("click.datepicker",X)}}),e(window).on("resize.datepicker",l),this;function l(){if(!a.inline){var t=e(o).offset();if("relative"==e(a.container).css("position")){var s=e(a.container).offset(),r=Math.max(0,t.left+n.outerWidth()-e("body").width()+16);n.css({top:t.top-s.top+e(o).outerHeight()+4,left:t.left-s.left-r})}else t.left<460?n.css({top:t.top+e(o).outerHeight()+parseInt(e("body").css("border-top")||0,10),left:t.left}):n.css({top:t.top+e(o).outerHeight()+parseInt(e("body").css("border-top")||0,10),left:t.left+e(o).width()-n.width()-16})}}function c(t){H(),f(),a.customOpenAnimation?a.customOpenAnimation.call(n.get(0),function(){e(o).trigger("datepicker-opened",{relatedTarget:n})}):n.slideDown(t,function(){e(o).trigger("datepicker-opened",{relatedTarget:n})}),e(o).trigger("datepicker-open",{relatedTarget:n}),N(),h(),l()}function f(){var e=a.getValue.call(d),n=e?e.split(a.separator):"";if(n&&(1==n.length&&a.singleDate||n.length>=2)){var s=a.format;s.match(/Do/)&&(s=s.replace(/Do/,"D"),n[0]=n[0].replace(/(\d+)(th|nd|st)/,"$1"),n.length>=2&&(n[1]=n[1].replace(/(\d+)(th|nd|st)/,"$1"))),i=!1,n.length>=2?S(m(n[0],s,t.locale(a.language)),m(n[1],s,t.locale(a.language))):1==n.length&&a.singleDate&&I(m(n[0],s,t.locale(a.language))),i=!0}}function m(e,a,n){return t(e,a,n).isValid()?t(e,a,n).toDate():t().toDate()}function h(){var e=n.find(".gap").css("margin-left");e&&(e=parseInt(e));var t=n.find(".month1").width(),a=n.find(".gap").width()+(e?2*e:0),s=n.find(".month2").width();n.find(".month-wrapper").width(t+a+s)}function u(e,a){n.find("."+e+" input[type=range].hour-range").val(t(a).hours()),n.find("."+e+" input[type=range].minute-range").val(t(a).minutes()),v(e,t(a).format("HH"),t(a).format("mm"))}function p(e,n){a[e]=parseInt(t(parseInt(n)).startOf("day").add(t(a[e+"Time"]).format("HH"),"h").add(t(a[e+"Time"]).format("mm"),"m").valueOf())}function v(e,s,r){switch(s&&n.find("."+e+" .hour-val").text(s),r&&n.find("."+e+" .minute-val").text(r),e){case"time1":a.start&&i("start",t(a.start)),i("startTime",t(a.startTime||t().valueOf()));break;case"time2":a.end&&i("end",t(a.end)),i("endTime",t(a.endTime||t().valueOf()))}function i(e,t){var n=t.format("HH"),i=t.format("mm");a[e]=t.startOf("day").add(s||n,"h").add(r||i,"m").valueOf()}x(),T(),W()}function g(e){var n=e;return"week-range"===a.batchMode?n="monday"===a.startOfWeek?t(parseInt(e)).startOf("isoweek").valueOf():t(parseInt(e)).startOf("week").valueOf():"month-range"===a.batchMode&&(n=t(parseInt(e)).startOf("month").valueOf()),n}function y(e){var n=e;return"week-range"===a.batchMode?n="monday"===a.startOfWeek?t(parseInt(e)).endOf("isoweek").valueOf():t(parseInt(e)).endOf("week").valueOf():"month-range"===a.batchMode&&(n=t(parseInt(e)).endOf("month").valueOf()),n}function D(n){if(!n.hasClass("invalid")){var s=n.attr("time");if(n.addClass("checked"),a.singleDate?(a.start=s,a.end=!1):"week"===a.batchMode?"monday"===a.startOfWeek?(a.start=t(parseInt(s)).startOf("isoweek").valueOf(),a.end=t(parseInt(s)).endOf("isoweek").valueOf()):(a.end=t(parseInt(s)).endOf("week").valueOf(),a.start=t(parseInt(s)).startOf("week").valueOf()):"workweek"===a.batchMode?(a.start=t(parseInt(s)).day(1).valueOf(),a.end=t(parseInt(s)).day(5).valueOf()):"weekend"===a.batchMode?(a.start=t(parseInt(s)).day(6).valueOf(),a.end=t(parseInt(s)).day(7).valueOf()):"month"===a.batchMode?(a.start=t(parseInt(s)).startOf("month").valueOf(),a.end=t(parseInt(s)).endOf("month").valueOf()):a.start&&a.end||!a.start&&!a.end?(a.start=g(s),a.end=!1):a.start&&(a.end=y(s),a.time.enabled&&p("end",a.end)),a.time.enabled&&(a.start&&p("start",a.start),a.end&&p("end",a.end)),!a.singleDate&&a.start&&a.end&&a.start>a.end){var r=a.end;a.end=y(a.start),a.start=g(r),a.time.enabled&&a.swapTime&&(u("time1",a.start),u("time2",a.end))}a.start=parseInt(a.start),a.end=parseInt(a.end),M(),a.start&&!a.end&&(e(o).trigger("datepicker-first-date-selected",{date1:new Date(a.start)}),w(n)),k(),x(),T(),W(),O()}}function b(e){if(e=parseInt(e,10),a.startDate&&$(e,a.startDate)<0)return!1;if(a.endDate&&$(e,a.endDate)>0)return!1;if(a.start&&!a.end&&!a.singleDate){if(a.maxDays>0&&Y(e,a.start)>a.maxDays)return!1;if(a.minDays>0&&Y(e,a.start)<a.minDays)return!1;if(a.selectForward&&e<a.start)return!1;if(a.selectBackward&&e>a.start)return!1;if(a.beforeShowDay&&"function"==typeof a.beforeShowDay){for(var t=!0,n=e;Y(n,a.start)>1;){if(!a.beforeShowDay(new Date(n))[0]){t=!1;break}if(Math.abs(n-a.start)<864e5)break;n>a.start&&(n-=864e5),n<a.start&&(n+=864e5)}if(!t)return!1}}return!0}function k(){return n.find(".day.invalid.tmp").removeClass("tmp invalid").addClass("valid"),a.start&&!a.end&&n.find(".day.toMonth.valid").each(function(){b(parseInt(e(this).attr("time"),10))?e(this).addClass("valid tmp").removeClass("invalid"):e(this).addClass("invalid tmp").removeClass("valid")}),!0}function w(t){var s=parseInt(t.attr("time")),r="";if(t.hasClass("has-tooltip")&&t.attr("data-tooltip"))r='<span class="tooltip-content">'+t.attr("data-tooltip")+"</span>";else if(!t.hasClass("invalid"))if(a.singleDate)n.find(".day.hovering").removeClass("hovering"),t.addClass("hovering");else if(n.find(".day").each(function(){var t=parseInt(e(this).attr("time"));a.start,a.end;t==s?e(this).addClass("hovering"):e(this).removeClass("hovering"),a.start&&!a.end&&(a.start<t&&s>=t||a.start>t&&s<=t)?e(this).addClass("hovering"):e(this).removeClass("hovering")}),a.start&&!a.end){var i=Y(s,a.start);a.hoveringTooltip&&("function"==typeof a.hoveringTooltip?r=a.hoveringTooltip(i,a.start,s):!0===a.hoveringTooltip&&i>1&&(r=i+" "+G("days")))}if(r){var o=t.offset(),d=n.offset(),l=o.left-d.left,c=o.top-d.top;l+=t.width()/2;var f=n.find(".date-range-length-tip"),m=f.css({visibility:"hidden",display:"none"}).html(r).width(),h=f.height();l-=m/2,c-=h,setTimeout(function(){f.css({left:l,top:c,display:"block",visibility:"visible"})},10)}else n.find(".date-range-length-tip").hide()}function M(){n.find(".day.hovering").removeClass("hovering"),n.find(".date-range-length-tip").hide()}function C(e){var n=e.val(),s=e.attr("name"),r=e.parents("table").hasClass("month1")?"month1":"month2",i="month1"===r?"month2":"month1",o=!!a.startDate&&t(a.startDate),d=!!a.endDate&&t(a.endDate),l=t(a[r])[s](n);o&&l.isSameOrBefore(o)&&(l=o.add("month2"===r?1:0,"month")),d&&l.isSameOrAfter(d)&&(l=d.add(a.singleMonth||"month1"!==r?0:-1,"month")),P(l,r),"month1"===r?(a.stickyMonths||t(l).isSameOrAfter(a[i],"month"))&&P(t(l).add(1,"month"),i):(a.stickyMonths||t(l).isSameOrBefore(a[i],"month"))&&P(t(l).add(-1,"month"),i),N()}function O(){!0===a.singleDate?i&&a.start&&a.autoClose&&R():i&&a.start&&a.end&&a.autoClose&&R()}function x(){var e=Math.ceil((a.end-a.start)/864e5)+1;a.singleDate?a.start&&!a.end?n.find(".drp_top-bar").removeClass("error").addClass("normal"):n.find(".drp_top-bar").removeClass("error").removeClass("normal"):a.maxDays&&e>a.maxDays?(a.start=!1,a.end=!1,n.find(".day").removeClass("checked"),n.find(".drp_top-bar").removeClass("normal").addClass("error").find(".error-top").html(G("less-than").replace("%d",a.maxDays))):a.minDays&&e<a.minDays?(a.start=!1,a.end=!1,n.find(".day").removeClass("checked"),n.find(".drp_top-bar").removeClass("normal").addClass("error").find(".error-top").html(G("more-than").replace("%d",a.minDays))):a.start||a.end?n.find(".drp_top-bar").removeClass("error").addClass("normal"):n.find(".drp_top-bar").removeClass("error").removeClass("normal"),a.singleDate&&a.start&&!a.end||!a.singleDate&&a.start&&a.end?n.find(".apply-btn").removeClass("disabled"):n.find(".apply-btn").addClass("disabled"),a.batchMode&&(a.start&&a.startDate&&$(a.start,a.startDate)<0||a.end&&a.endDate&&$(a.end,a.endDate)>0)&&(a.start=!1,a.end=!1,n.find(".day").removeClass("checked"))}function T(t,s){var r;n.find(".start-day").html("..."),n.find(".end-day").html("..."),n.find(".selected-days").hide(),a.start&&n.find(".start-day").html(L(new Date(parseInt(a.start)))),a.end&&n.find(".end-day").html(L(new Date(parseInt(a.end)))),a.start&&a.singleDate?(n.find(".apply-btn").removeClass("disabled"),r=L(new Date(a.start)),a.setValue.call(d,r,L(new Date(a.start)),L(new Date(a.end))),i&&!s&&e(o).trigger("datepicker-change",{value:r,date1:new Date(a.start)})):a.start&&a.end?(n.find(".selected-days").show().find(".selected-days-num").html(Y(a.end,a.start)),n.find(".apply-btn").removeClass("disabled"),r=L(new Date(a.start))+a.separator+L(new Date(a.end)),a.setValue.call(d,r,L(new Date(a.start)),L(new Date(a.end))),i&&!s&&e(o).trigger("datepicker-change",{value:r,date1:new Date(a.start),date2:new Date(a.end)})):t?n.find(".apply-btn").removeClass("disabled"):n.find(".apply-btn").addClass("disabled")}function Y(e,a){return Math.abs(t(e).diff(t(a),"d"))+1}function S(e,t,n){if(e.getTime()>t.getTime()){var s=t;t=e,e=s,s=null}var r=!0;if(a.startDate&&$(e,a.startDate)<0&&(r=!1),a.endDate&&$(t,a.endDate)>0&&(r=!1),!r)return P(a.startDate,"month1"),P(_(a.startDate),"month2"),void N();a.start=e.getTime(),a.end=t.getTime(),a.time.enabled&&(u("time1",e),u("time2",t)),(a.stickyMonths||$(e,t)>0&&0===F(e,t))&&(a.lookBehind?e=q(t):t=_(e)),a.stickyMonths&&!1!==a.endDate&&F(t,a.endDate)>0&&(e=q(e),t=q(t)),a.stickyMonths||0===F(e,t)&&(a.lookBehind?e=q(t):t=_(e)),P(e,"month1"),P(t,"month2"),N(),x(),T(!1,n),O()}function I(e){var t=!0;if(a.startDate&&$(e,a.startDate)<0&&(t=!1),a.endDate&&$(e,a.endDate)>0&&(t=!1),t){if(a.start=e.getTime(),a.time.enabled&&u("time1",e),P(e,"month1"),!0!==a.singleMonth)P(_(e),"month2");N(),T(),O()}else P(a.startDate,"month1")}function W(){(a.start||a.end)&&(n.find(".day").each(function(){var n=parseInt(e(this).attr("time")),s=a.start,r=a.end;a.time.enabled&&(n=t(n).startOf("day").valueOf(),s=t(s||t().valueOf()).startOf("day").valueOf(),r=t(r||t().valueOf()).startOf("day").valueOf()),a.start&&a.end&&r>=n&&s<=n||a.start&&!a.end&&t(s).format("YYYY-MM-DD")==t(n).format("YYYY-MM-DD")?e(this).addClass("checked"):e(this).removeClass("checked"),a.start&&t(s).format("YYYY-MM-DD")==t(n).format("YYYY-MM-DD")?e(this).addClass("first-date-selected"):e(this).removeClass("first-date-selected"),a.end&&t(r).format("YYYY-MM-DD")==t(n).format("YYYY-MM-DD")?e(this).addClass("last-date-selected"):e(this).removeClass("last-date-selected")}),n.find(".week-number").each(function(){e(this).attr("data-start-time")==a.startWeek&&e(this).addClass("week-number-selected")}))}function P(s,r){var i=function(e,n){var s=(e=t(e)).get("month"),r='<div class="month-element">'+j(s)+"</div>";if(!a.monthSelect)return r;var i=!!a.startDate&&t(a.startDate).add(a.singleMonth||"month2"!==n?0:1,"month"),o=!!a.endDate&&t(a.endDate).add(a.singleMonth||"month1"!==n?0:-1,"month"),d=i&&e.isSame(i,"year")?i.get("month"):0,l=o&&e.isSame(o,"year")?o.get("month"):11,c=Math.min(d,s),f=Math.max(l,s);if(c===f)return r;return A("month",V({minSelectable:d,maxSelectable:l,minVisible:c,maxVisible:f},s,function(e){return j(e)}))}(s=t(s).toDate(),r),o=function(e,n){var s=(e=t(e)).get("year"),r='<div class="month-element">'+s+"</div>";if(!a.yearSelect)return r;var i=a.yearSelect&&"function"==typeof a.yearSelect,o=!!a.startDate&&t(a.startDate).add(a.singleMonth||"month2"!==n?0:1,"month"),d=!!a.endDate&&t(a.endDate).add(a.singleMonth||"month1"!==n?0:-1,"month"),l=i?a.yearSelect(s):a.yearSelect.slice(),c=o?Math.max(l[0],o.get("year")):Math.min(l[0],s),f=d?Math.min(l[1],d.get("year")):Math.max(l[1],s),m=Math.min(c,s),h=Math.max(f,s);if(m===h)return r;return A("year",V({minSelectable:c,maxSelectable:f,minVisible:m,maxVisible:h},s))}(s,r);n.find("."+r+" .month-name").html(i+" "+o),n.find("."+r+" tbody").html(function(e){var n=[];e.setDate(1);new Date(e.getTime()-864e5);var s,r,i=new Date,o=e.getDay();0===o&&"monday"===a.startOfWeek&&(o=7);if(o>0)for(var d=o;d>0;d--){var l=new Date(e.getTime()-864e5*d);r=b(l.getTime()),a.startDate&&$(l,a.startDate)<0&&(r=!1),a.endDate&&$(l,a.endDate)>0&&(r=!1),n.push({date:l,type:"lastMonth",day:l.getDate(),time:l.getTime(),valid:r})}for(var c=e.getMonth(),d=0;d<40;d++)s=t(e).add(d,"days").toDate(),r=b(s.getTime()),a.startDate&&$(s,a.startDate)<0&&(r=!1),a.endDate&&$(s,a.endDate)>0&&(r=!1),n.push({date:s,type:s.getMonth()==c?"toMonth":"nextMonth",day:s.getDate(),time:s.getTime(),valid:r});for(var f=[],m=0;m<6&&"nextMonth"!=n[7*m].type;m++){f.push("<tr>");for(var l=0;l<7;l++){var h="monday"==a.startOfWeek?l+1:l;s=n[7*m+h];var u=t(s.time).format("L")==t(i).format("L");if(s.extraClass="",s.tooltip="",s.valid&&a.beforeShowDay&&"function"==typeof a.beforeShowDay){var p=a.beforeShowDay(t(s.time).toDate());s.valid=p[0],s.extraClass=p[1]||"",s.tooltip=p[2]||"",""!==s.tooltip&&(s.extraClass+=" has-tooltip ")}var v={time:s.time,"data-tooltip":s.tooltip,class:"day "+s.type+" "+s.extraClass+" "+(s.valid?"valid":"invalid")+" "+(u?"real-today":"")};0===l&&a.showWeekNumbers&&f.push('<td><div class="week-number" data-start-time="'+s.time+'">'+a.getWeekNumber(s.date)+"</div></td>"),f.push("<td "+Q({},a.dayTdAttrs,s)+"><div "+Q(v,a.dayDivAttrs,s)+">"+U(s.time,s.day)+"</div></td>")}f.push("</tr>")}return f.join("")}(s)),a[r]=s,k(),n.find(".day").off("click").click(function(t){D(e(this))}),n.find(".day").off("mouseenter").mouseenter(function(t){w(e(this))}),n.find(".day").off("mouseleave").mouseleave(function(e){n.find(".date-range-length-tip").hide(),a.singleDate&&M()}),n.find(".week-number").off("click").click(function(s){var r,i,o,d;r=e(this),d=parseInt(r.attr("data-start-time"),10),a.startWeek?(n.find(".week-number-selected").removeClass("week-number-selected"),i=new Date(d<a.startWeek?d:a.startWeek),o=new Date(d<a.startWeek?a.startWeek:d),a.startWeek=!1,a.start=t(i).day("monday"==a.startOfWeek?1:0).valueOf(),a.end=t(o).day("monday"==a.startOfWeek?7:6).valueOf()):(a.startWeek=d,r.addClass("week-number-selected"),i=new Date(d),a.start=t(i).day("monday"==a.startOfWeek?1:0).valueOf(),a.end=t(i).day("monday"==a.startOfWeek?7:6).valueOf()),k(),x(),T(),W(),O()}),n.find(".month").off("change").change(function(t){C(e(this))}),n.find(".year").off("change").change(function(t){C(e(this))})}function V(e,t,a){var n=[];a=a||function(e){return e};for(var s=e.minVisible;s<=e.maxVisible;s++)n.push({value:s,text:a(s),selected:s===t,disabled:s<e.minSelectable||s>e.maxSelectable});return n}function A(e,t){for(var a,n='<div class="select-wrapper"><select class="'+e+'" name="'+e+'">',s=0,r=t.length;s<r;s++){var i=t[s];n+='<option value="'+i.value+'"'+(i.selected?" selected":"")+(i.disabled?" disabled":"")+">"+i.text+"</option>",i.selected&&(a=i.text)}return n+="</select>"+a+"</div>"}function B(e,t){n.find("."+t).append("<div><span>"+G("Time")+': <span class="hour-val">00</span>:<span class="minute-val">00</span></span></div><div class="hour"><label>'+G("Hour")+': <input type="range" class="hour-range" name="hour" min="0" max="23"></label></div><div class="minute"><label>'+G("Minute")+': <input type="range" class="minute-range" name="minute" min="0" max="59"></label></div>'),u(t,e)}function j(e){return G("month-name")[e]}function L(e){return t(e).format(a.format)}function N(){W();var e=parseInt(t(a.month1).format("YYYYMM")),s=parseInt(t(a.month2).format("YYYYMM")),r=Math.abs(e-s);r>1&&89!=r?n.addClass("has-gap").removeClass("no-gap").find(".gap").css("visibility","visible"):n.removeClass("has-gap").addClass("no-gap").find(".gap").css("visibility","hidden");var i=n.find("table.month1").height(),o=n.find("table.month2").height();n.find(".gap").height(Math.max(i,o)+10)}function R(){if(!a.alwaysOpen){var t=function(){e(o).data("date-picker-opened",!1),e(o).trigger("datepicker-closed",{relatedTarget:n})};a.customCloseAnimation?a.customCloseAnimation.call(n.get(0),t):e(n).slideUp(a.duration,t),e(o).trigger("datepicker-close",{relatedTarget:n})}}function H(){P(a.month1,"month1"),P(a.month2,"month2")}function F(e,a){var n=parseInt(t(e).format("YYYYMM"))-parseInt(t(a).format("YYYYMM"));return n>0?1:0===n?0:-1}function $(e,a){var n=parseInt(t(e).format("YYYYMMDD"))-parseInt(t(a).format("YYYYMMDD"));return n>0?1:0===n?0:-1}function _(e){return t(e).add(1,"months").toDate()}function q(e){return t(e).add(-1,"months").toDate()}function E(){var e=a.showWeekNumbers?"<th>"+G("week-number")+"</th>":"";return"monday"==a.startOfWeek?e+"<th>"+G("week-1")+"</th><th>"+G("week-2")+"</th><th>"+G("week-3")+"</th><th>"+G("week-4")+"</th><th>"+G("week-5")+"</th><th>"+G("week-6")+"</th><th>"+G("week-7")+"</th>":e+"<th>"+G("week-7")+"</th><th>"+G("week-1")+"</th><th>"+G("week-2")+"</th><th>"+G("week-3")+"</th><th>"+G("week-4")+"</th><th>"+G("week-5")+"</th><th>"+G("week-6")+"</th>"}function z(e){return e=t(e),!(!a.startDate||!e.endOf("month").isBefore(a.startDate))||!(!a.endDate||!e.startOf("month").isAfter(a.endDate))}function Q(t,a,n){var s=e.extend(!0,{},t);e.each(a,function(e,t){var a=t(n);for(var r in a)s.hasOwnProperty(r)?s[r]+=a[r]:s[r]=a[r]});var r="";for(var i in s)s.hasOwnProperty(i)&&(r+=i+'="'+s[i]+'" ');return r}function U(e,t){return a.showDateFilter&&"function"==typeof a.showDateFilter?a.showDateFilter(e,t):t}function G(t){var a=t.toLowerCase(),n=t in r?r[t]:a in r?r[a]:null,s=e.dateRangePickerLanguages.default;return null==n&&(n=t in s?s[t]:a in s?s[a]:""),n}function J(){var e=a.defaultTime?a.defaultTime:new Date;return a.lookBehind?(a.startDate&&F(e,a.startDate)<0&&(e=_(t(a.startDate).toDate())),a.endDate&&F(e,a.endDate)>0&&(e=t(a.endDate).toDate())):(a.startDate&&F(e,a.startDate)<0&&(e=t(a.startDate).toDate()),a.endDate&&F(_(e),a.endDate)>0&&(e=q(t(a.endDate).toDate()))),a.singleDate&&(a.startDate&&F(e,a.startDate)<0&&(e=t(a.startDate).toDate()),a.endDate&&F(e,a.endDate)>0&&(e=t(a.endDate).toDate())),e}function K(e){e||(e=J()),a.lookBehind?(P(q(e),"month1"),P(e,"month2")):(P(e,"month1"),P(_(e),"month2")),a.singleDate&&P(e,"month1"),W(),N()}function X(t){(function(t,a){return a.contains(t.target)||t.target==a||null!=a.childNodes&&e.inArray(t.target,a.childNodes)>=0})(t,o[0])||n.is(":visible")&&R()}}});